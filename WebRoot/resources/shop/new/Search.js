if(typeof(SearchJS)=="undefined"||SearchJS==null||!SearchJS){SearchJS={autoSuggestTimer:-1,autoSuggestKeystrokeDelay:400,autoSuggestHover:false,autoSuggestPreviousTerm:"",autoSuggestURL:"",autoSelectOption:-1,historyIndex:-1,retrievedCachedSuggestions:false,TOTAL_SUGGESTED:4,TOTAL_HISTORY:2,AUTOSUGGEST_THRESHOLD:1,DYNAMIC_AUTOSUGGEST_THRESHOLD:1,CACHED_AUTOSUGGEST_OFFSET:1000,END_OF_LIST:false,STATIC_CONTENT_SECTION_DIV:["autoSuggestStatic_1","autoSuggestStatic_2","autoSuggestStatic_3"],staticContentHeaderHistory:"",CachedSuggestionsURL:"",SearchAutoSuggestServletURL:"",searchDepartmentHoverTimeout:"",searchSuggestionHoverTimeout:"",suggestContext:{},staticContent:new Array,deafultSearch:"",storeId:"",inputValue:"",searchDepartmentSelect:function(B,A){byId("searchDepartmentLabel").innerHTML=A.innerHTML;byId("search_categoryId").value=B;this.hideSearchDepartmentList();return false},cancelEvent:function(A){if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}A.cancelBubble=true;A.cancel=true;A.returnValue=false},searchDepartmentKeyPressed:function(D,B,A,E,C){},hideSearchDepartmentList:function(){},init:function(){$("#searchBar").bind("focus",SearchJS._onFocus);$("#searchBar").bind("keyup",SearchJS._onKeyUp);$("#searchList_ul").bind("mouseleave",SearchJS._onMouseLeave);$("#searchList_ul").bind("keyup",SearchJS._onKeyUp);$("#SimpleSearchForm_SearchTerm").bind("click",SearchJS._onInputClick);$("#SimpleSearchForm_SearchTerm").bind("blur",SearchJS._onInputBlur)},_onInputClick:function(){$("#SimpleSearchForm_SearchTerm").val(SearchJS.inputValue)},_onInputBlur:function(){if($("#SimpleSearchForm_SearchTerm").val()==""){$("#SimpleSearchForm_SearchTerm").val(SearchJS.deafultSearch)}},_onMouseOver:function(A){$("#searchList_ul li").each(function(){$(this).removeClass("curr")});$(A).addClass("curr")},_onMouseLeave:function(){if(SearchJS.inputValue==""){$("#SimpleSearchForm_SearchTerm").val(SearchJS.deafultSearch)}$("#searchList_ul").html("");$("#searchList_ul").hide()},showSearchComponent:function(){},hideSearchComponent:function(){},_showMobileSearchComponent:function(){},setCachedSuggestionsURL:function(A){this.CachedSuggestionsURL=getAbsoluteURL()+A},setAutoSuggestURL:function(A){this.SearchAutoSuggestServletURL=getAbsoluteURL()+A},_onFocus:function(){$("#SimpleSearchForm_SearchTerm").val(SearchJS.inputValue);if($("#searchList_ul li").length>0){$("#searchList_ul").show()}},_onBlur:function(A){if($("#SimpleSearchForm_SearchTerm").val()==""){$("#SimpleSearchForm_SearchTerm").val(SearchJS.deafultSearch)}$("#searchList_ul").html("");$("#searchList_ul").hide()},_MobileonBlur:function(A){clearTimeout(this.searchSuggestionHoverTimeout);this.searchSuggestionHoverTimeout=setTimeout("SearchJS.showAutoSuggest(false)",100)},_onKeyPress:function(A){return A.keyCode!=dojo.keys.ENTER},_onKeyUp:function(C){if(C.keyCode==13){$("#SimpleSearchForm_SearchTerm").focus();if($.trim($("#SimpleSearchForm_SearchTerm").val())==null||$.trim($("#SimpleSearchForm_SearchTerm").val())==""){$("#SimpleSearchForm_SearchTerm").val(SearchJS.deafultSearch)}if($.trim($("#SimpleSearchForm_SearchTerm").val())!=null&&$.trim($("#SimpleSearchForm_SearchTerm").val())!=""){$("#searchBox").submit()}}else{if(C.keyCode==38){var A=$("#searchList_ul li");var B=A.length;var D=-1;$("#searchList_ul li").each(function(F){if($(this).attr("class")=="curr"){D=F}});if(D>-1){$("#searchList_ul li:eq("+D+")").removeClass()}if(D==0||D==-1){D=B}var E=$("#searchList_ul li:eq("+(D-1)+")");$(E).addClass("curr");$("#SimpleSearchForm_SearchTerm").val($($(E).find("a")[0]).text());SearchJS.inputValue=$("#SimpleSearchForm_SearchTerm").val()}else{if(C.keyCode==40){var A=$("#searchList_ul li");var B=A.length;var D=-1;$("#searchList_ul li").each(function(F){if($(this).attr("class")=="curr"){D=F}});if(D>-1){$("#searchList_ul li:eq("+D+")").removeClass()}if(D==B-1||D==-1){D=-1}var E=$("#searchList_ul li:eq("+(D+1)+")");$(E).addClass("curr");$("#SimpleSearchForm_SearchTerm").val($($(E).find("a")[0]).text());SearchJS.inputValue=$("#SimpleSearchForm_SearchTerm").val()}else{if(C.keyCode==27){$("#searchList_ul").html("");$("#searchList_ul").hide()}else{if(C.shiftKey&&C.keyCode==9){$("#SimpleSearchForm_SearchTerm").attr("placeholder",SearchJS.deafultSearch);$("#searchList_ul").html("");$("#searchList_ul").hide()}else{if(C.keyCode==9){$("#SimpleSearchForm_SearchTerm").attr("placeholder",SearchJS.deafultSearch);$("#searchList_ul").html("");$("#searchList_ul").hide()}else{SearchJS.inputValue=$("#SimpleSearchForm_SearchTerm").val();SearchJS.doSearchSuggestion($("#SimpleSearchForm_SearchTerm").val())}}}}}}},doSearchSuggestion:function(A){$.ajax({type:"GET",url:this.SearchAutoSuggestServletURL,data:{searchTerm:A,count:10},dataType:"json",success:function(B){$("#searchList_ul").html("");var G="";if(B!=null&&B.terms!=null&&B.terms.length>0){$("#searchList_ul").show();for(var E=0,C=B.terms.length;E<C;E++){var I=B.terms[E];for(var H in I){var F="";if(H.indexOf("_|_")>-1){F=H.split("_|_")[1]}else{F=H}var D="";if(F.length>15){D=F.substring(0,15)+"..."}else{D=F}G=G+"<li onmouseover='javascript:SearchJS._onMouseOver(this)' onclick='javascript:SearchJS._onClick(this)'><a class='searchListTitle' title='"+F+"'>"+D+"</a><a class='searchListCon'>约"+I[H]+"个商品</a></li>"}}}$("#searchList_ul").html(G)}})},_onKeyTab:function(A){if(A.keyCode=="9"||A.which=="9"){dojo.byId("searchFilterButton").focus()}},_MobileonKeyUp:function(A){var B=document.getElementById("mobileSearchDropdown");B.style.display="block";this.doAutoSuggest(A,this.SearchAutoSuggestServletURL,dojo.byId("MobileSimpleSearchForm_SearchTerm").value)},_handleEnterKey:function(){document.CatalogSearchForm.searchTerm.value=document.CatalogSearchForm.searchTerm.value.trim();if(document.CatalogSearchForm.searchTerm.value.length>0){if(this.END_OF_LIST){this.gotoAdvancedSearch(byId("advancedSearch").href)}else{if(this.autoSuggestURL!=""){document.location.href=this.autoSuggestURL}else{document.CatalogSearchForm.searchTerm.value=document.CatalogSearchForm.searchTerm.value.trim();submitSpecifiedForm(document.CatalogSearchForm)}}}},_onClick:function(B){var A=$(B).find("a");$("#SimpleSearchForm_SearchTerm").val($(A[0]).text());$("#SimpleSearchForm_SearchTerm").focus();$("#searchBox").submit()},_MobileonClick:function(A){document.MobileCatalogSearchForm.searchTerm.value=trim(document.MobileCatalogSearchForm.searchTerm.value);if(document.MobileCatalogSearchForm.searchTerm.value.length>0){if(typeof TealeafWCJS!="undefined"){TealeafWCJS.processDOMEvent(A)}submitSpecifiedForm(document.MobileCatalogSearchForm)}return false},doDynamicAutoSuggest:function(B,A,C){if(this.autoSuggestTimer!=-1){clearTimeout(this.autoSuggestTimer);this.autoSuggestTimer=-1}this.autoSuggestTimer=setTimeout(function(){SearchJS.findSuggestByAjax(B+"&term="+encodeURIComponent(A));this.autoSuggestTimer=-1},this.autoSuggestKeystrokeDelay)},gotoAdvancedSearch:function(B){var A=byId("SimpleSearchForm_SearchTerm").value;document.location.href=B+"&searchTerm="+A},showAutoSuggest:function(B){var C=document.getElementById("autoSuggest_Result_div");if($.browser.msie&&($.browser.version<7)){var A=document.getElementById("autoSuggest_content_div");var D=document.getElementById("autoSuggestDropDownIFrame")}if(C!=null&&C!="undefined"){if(B){C.style.display="block";if($.browser.msie&&($.browser.version<7)){D.style.height=A.scrollHeight;D.style.display="block"}}else{if($.browser.msie&&($.browser.version<7)){D.style.display="none";D.style.height=0}C.style.display="none"}}},showAutoSuggestIfResults:function(){var A=document.getElementById("mobileSearchDropdown");if(typeof(staticContent)!="undefined"&&document.getElementById(this.STATIC_CONTENT_SECTION_DIV[0]).innerHTML==""&&document.getElementById("autoSuggestHistory").innerHTML==""&&document.getElementById("dynamicAutoSuggestTotalResults")==null){this.showAutoSuggest(false)}else{if(A!=null&&A.style.display=="block"){if(document.getElementById("MobileSimpleSearchForm_SearchTerm").value.length<=this.AUTOSUGGEST_THRESHOLD){this.showAutoSuggest(false)}else{this.showAutoSuggest(true)}}else{if(document.CatalogSearchForm.searchTerm.value.length<=this.AUTOSUGGEST_THRESHOLD){this.showAutoSuggest(false)}else{this.showAutoSuggest(true)}}}},selectAutoSuggest:function(A){$("#SimpleSearchForm_SearchTerm").val(A);$("#searchBox").submit()},highLightSelection:function(F,D){var E=document.getElementById("autoSelectOption_"+D);if(E!=null&&E!="undefined"){if(F){E.className="autoSuggestSelected";var C=document.getElementById("mobileSearchDropdown");if(C!=null&&C.style.display=="block"){var B=document.getElementById("MobileSimpleSearchForm_SearchTerm")}else{var B=document.CatalogSearchForm.searchTerm}B.setAttribute("aria-activedescendant","suggestionItem_"+D);var A=document.getElementById("dynamicAutoSuggestTotalResults");if((A!=null&&A!="undefined"&&D<A.value)||(D>=this.historyIndex)){B.value=E.title;this.autoSuggestPreviousTerm=E.title;this.autoSuggestURL=""}else{this.autoSuggestURL=E.href}}else{E.className=""}return true}else{return false}},enableAutoSelect:function(C){var B="suggestionItem_"+C;$("#"+B).addClass("curr");var A=$("#"+B+" a")[0];$("#SimpleSearchForm_SearchTerm").val($(A).html())},resetAutoSuggestKeyword:function(){var A=document.getElementById("autoSuggestOriginalTerm");if(A!=null&&A!="undefined"){var C=document.getElementById("mobileSearchDropdown");if(C!=null&&C.style.display=="block"){var B=document.getElementById("MobileSimpleSearchForm_SearchTerm")}else{var B=document.CatalogSearchForm.searchTerm}B.value=A.value;this.autoSuggestPreviousTerm=A.value}},clearAutoSuggestResults:function(){for(var A=0;A<staticContent.length;A++){document.getElementById(this.STATIC_CONTENT_SECTION_DIV[A]).innerHTML=""}this.autoSuggestPreviousTerm="";this.autoSuggestURL="";document.getElementById("autoSuggestDynamic_Result_div").innerHTML="";this.showAutoSuggest(false)},doAutoSuggest:function(C,B,A){if(A.length>this.AUTOSUGGEST_THRESHOLD&&A==this.autoSuggestPreviousTerm){return}else{this.autoSuggestPreviousTerm=A}if(A.length<=this.AUTOSUGGEST_THRESHOLD){return}if(this.autoSuggestTimer!=-1){clearTimeout(this.autoSuggestTimer);this.autoSuggestTimer=-1}if(A!=""){this.autoSelectOption=-1;if(A.length>this.DYNAMIC_AUTOSUGGEST_THRESHOLD){var D=true;this.doDynamicAutoSuggest(B,A,D)}else{}}else{}},tokenizeForBidi:function(B,I,A,C){var G=B.split(" > ");var J="";var F="";if(G.length>0){J=J+"<div class='category_list'>";for(i=0;i<G.length;i++){if(i!=0){J=J+"<span class='gt'>&nbsp; > &nbsp;</span>"}if(i==G.length-1){var D=I.toLowerCase().indexOf(C);var E=I.substr(0,D);var K=I.substr(D+A.length);var H="<span class='highlight'>"+A+"</span>";F=E+H+K}else{F=G[i]}J=J+F}J=J+"</div>"}return J},doStaticAutoSuggest:function(C){var X=["","","","","",""];var K=0;var I=C.toLowerCase();var R=this.CACHED_AUTOSUGGEST_OFFSET;var P="<div class='list_section'><div";var N="</div></div>";for(var E=0;E<staticContent.length;E++){var B=0;for(var T=0;T<staticContent[E].length;T++){var U=staticContent[E][T][0];var O=staticContent[E][T][1];var L=staticContent[E][T][2];var A=U.toLowerCase().indexOf(I);if(A!=-1){var H=this.tokenizeForBidi(L,U,C,I);X[E]=X[E]+"<ul class='autoSuggestDivNestedList'><li id='suggestionItem_"+R+"' role='listitem' tabindex='-1'><a id='autoSelectOption_"+R+"' title='"+U+"' onmouseout='this.className=\"\"; this.autoSuggestURL=\"\";' onclick='SearchJS.hideSearchComponent();' onmouseover='SearchJS.enableAutoSelect("+R+"); this.autoSuggestURL=this.href;' href=\""+O+'">'+H+"</a></li></ul>";B++;R++;if(B>=this.TOTAL_SUGGESTED){break}}}}for(var E=0;E<staticContent.length;E++){document.getElementById(this.STATIC_CONTENT_SECTION_DIV[E]).innerHTML="";if(X[E]!=""){var J="<ul class='autoSuggestDivNestedList'><li class='heading'><span>"+staticContentHeaders[E]+"</span></li></ul>";document.getElementById(this.STATIC_CONTENT_SECTION_DIV[K]).innerHTML=J+P+" role='list' title='"+staticContentHeaders[E]+"' aria-label='"+staticContentHeaders[E]+"'>"+X[E]+N;K++}}var W="";var Q=document.getElementById("autoSuggestHistory");Q.innerHTML="";var S=new Array();this.historyIndex=R;var D=getCookie("searchTermHistory");if(typeof(D)!="undefined"){var F=D.split("|");var B=0;for(var E=F.length-1;E>0;E--){var V=F[E];var G=V.toLowerCase();if(G.match("^"+I)==I){var M=false;for(var T=0;T<S.length;T++){if(S[T]==G){M=true;break}}if(!M){W=W+"<ul class='autoSuggestDivNestedList'><li id='suggestionItem_"+R+"' role='listitem' tabindex='-1'><a href='#' onmouseout='this.className=\"\"' onmouseover='SearchJS.enableAutoSelect("+R+");' onclick='SearchJS.selectAutoSuggest(this.title); return false;' title='"+V+"' id='autoSelectOption_"+R+"'><strong>"+C+"</strong>"+V.substring(C.length,V.length)+"</a></li></ul>";S.push(G);B++;R++;if(B>=this.TOTAL_HISTORY){break}}}}}if(W!=""){var J="<ul class='autoSuggestDivNestedList'><li class='heading'><span>"+this.staticContentHeaderHistory+"</span></li></ul>";Q.innerHTML=J+P+" title='"+this.staticContentHeaderHistory+"'>"+W+N;K++}if(K>0){this.showAutoSuggest(true);return true}return false},retrieveCachedSuggestions:function(){if(!this.retrievedCachedSuggestions){SearchJS.findSuggestByAjax(SearchJS.showSuggestContext)}},updateSearchTermHistoryCookie:function(C){var D="searchTermHistory";var A="|"+C;var B=getCookie(D);if(typeof(B)!="undefined"){A=dojo.cookie(D)+A}dojo.cookie(D,A,{path:"/"})},updateSearchTermHistoryCookieAndRedirect:function(B,A){this.updateSearchTermHistoryCookie(B);document.location.href=A},isValidNumber:function(A){return !isNaN(parseFloat(A))&&isFinite(A)&&A>=0},validateForm:function(B){B["minPrice"].value=trim(B["minPrice"].value);B["maxPrice"].value=trim(B["maxPrice"].value);var E=B["minPrice"].value;var C=B["maxPrice"].value;var F=this.isValidNumber(E);var H=this.isValidNumber(C);if(E.length>0&&!F){MessageHelper.formErrorHandleClient(B["minPrice"].id,MessageHelper.messages["EDPPaymentMethods_AMOUNT_NAN"]);return false}else{if(C.length>0&&!H){MessageHelper.formErrorHandleClient(B["maxPrice"].id,MessageHelper.messages["EDPPaymentMethods_AMOUNT_NAN"]);return false}else{if(E.length>0&&C.length>0&&parseFloat(E)>parseFloat(C)){MessageHelper.formErrorHandleClient(B["maxPrice"].id,MessageHelper.messages["ERROR_PRICE_RANGE"]);return false}}}B["searchTerm"].value=trim(B["searchTerm"].value);B["filterTerm"].value=trim(B["filterTerm"].value);B["manufacturer"].value=trim(B["manufacturer"].value);var A=B["searchTerm"].value;var G=B["filterTerm"].value;var D=B["manufacturer"].value;if(A.length==0&&G.length==0&&D.length==0){MessageHelper.formErrorHandleClient(B["searchTerm"].id,MessageHelper.messages["ERROR_EMPTY_SEARCH_FIELDS"]);return false}B.submit()},findSuggestByAjax:function(A){$.ajax({type:"GET",url:A,data:{},dataType:"json",success:function(B){$("#searchList_ul").html(B)}})},showSuggestContext:function(A){$("#autoSuggestDiv").html(A)}}};